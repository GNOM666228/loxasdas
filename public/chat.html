<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ß–∞—Ç</title>
    <link rel="stylesheet" href="chat.css">
    <script defer src="chat.js"></script>
</head>
<body>
    <div id="chat">
        <!-- –ó–Ω–∞—á–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profileSection">
            <button id="profileButton">üë§</button>
            <!-- –ú–µ–Ω—é –ø—Ä–æ—Ñ–∏–ª—è -->
            <div id="profileMenu" class="menu-hidden">
                <ul>
                    <li id="changeAvatar">–ò–∑–º–µ–Ω–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</li>
                    <li id="changePassword">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</li>
                    <li id="notificationSettings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</li>
                    <li id="themeSettings">–¢–µ–º–∞ —á–∞—Ç–∞</li>
                    <li id="logout">–í—ã–π—Ç–∏</li>
                </ul>
            </div>
        </div>

        <!-- –õ–µ–≤–æ–µ –º–µ–Ω—é —Å –ø–æ–∏—Å–∫–æ–º –¥—Ä—É–∑–µ–π -->
        <div id="friendList">
            <h3 id="friendTitle">–ù–∞–π—Ç–∏ –¥—Ä—É–∑–µ–π</h3>
            <input type="text" id="friendSearch" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –¥—Ä—É–≥–∞...">
            <div id="friendSuggestions"></div> <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –¥–ª—è –ø–æ–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π -->
            <button id="searchFriendButton">–ù–∞–π—Ç–∏ –¥—Ä—É–≥–∞</button>

            <h3>–î—Ä—É–∑—å—è</h3>
            <div id="friendsContainer">
                <!-- –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π –±—É–¥–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –û–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ -->
        <div id="chatArea">
            <div id="messages">
                <div id="welcomeMessage">–í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–∞ –¥–ª—è –Ω–∞—á–∞–ª–∞ —á–∞—Ç–∞</div>
            </div>
            
            <!-- –í–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è -->
            <div id="inputArea" class="hidden">
                <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." disabled>
                <button class="icon-button" id="sendMessage">‚û°Ô∏è</button>
                <button class="icon-button" id="sendFile">üìÅ</button>
                <button class="icon-button" id="clearChat">üóëÔ∏è</button>
            </div>
        </div>
    </div>

    <script>
        // –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ—Ñ–∏–ª–µ–º
        document.addEventListener("DOMContentLoaded", () => {
            const profileButton = document.getElementById("profileButton");
            const profileMenu = document.getElementById("profileMenu");

            // –õ–æ–≥–∏–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é –ø—Ä–æ—Ñ–∏–ª—è
            profileButton.addEventListener("click", () => {
                profileMenu.classList.toggle("menu-hidden"); // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –∫–ª–∞—Å—Å hidden –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é
            });
        });

        // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
        document.addEventListener("DOMContentLoaded", () => {
            const socket = new WebSocket(`ws://${window.location.host}`);

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
            document.getElementById("sendMessage").addEventListener("click", () => {
                const messageInput = document.getElementById("messageInput");
                const message = messageInput.value.trim();
                
                if (message !== "") {
                    socket.send(JSON.stringify({ text: message, sender: 'me' }));
                    messageInput.value = ""; // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
                }
            });

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
            socket.addEventListener("message", (event) => {
                const messageData = JSON.parse(event.data);
                displayMessage(messageData.text, messageData.sender === 'me');
            });

            // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ
            function displayMessage(text, isMine) {
                const messagesDiv = document.getElementById("messages");
                const messageElement = document.createElement("div");
                messageElement.classList.add("message", isMine ? "my-message" : "other-message");
                messageElement.textContent = text;
                messagesDiv.appendChild(messageElement);
                messagesDiv.scrollTop = messagesDiv.scrollHeight; // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
            }
        });
    </script>
</body>
</html>
